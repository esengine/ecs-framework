name: AI Issue Moderator

on:
  issues:
    types: [opened]
  issue_comment:
    types: [created]
  workflow_dispatch:
    inputs:
      issue_number:
        description: 'Issue ç¼–å·ï¼ˆç•™ç©ºåˆ™æ£€æŸ¥æ‰€æœ‰æ‰“å¼€çš„ issueï¼‰'
        required: false
        type: string

permissions:
  issues: write
  contents: read

jobs:
  moderate:
    runs-on: ubuntu-latest
    steps:
      - name: Get issue number
        id: issue
        run: |
          if [ "${{ github.event_name }}" = "workflow_dispatch" ]; then
            if [ -n "${{ github.event.inputs.issue_number }}" ]; then
              echo "number=${{ github.event.inputs.issue_number }}" >> $GITHUB_OUTPUT
            else
              echo "number=all" >> $GITHUB_OUTPUT
            fi
          else
            echo "number=${{ github.event.issue.number }}" >> $GITHUB_OUTPUT
          fi
      - name: AI Content Moderation
        uses: github/content-moderation-action@v1
        with:
          # æ£€æµ‹åƒåœ¾å†…å®¹
          spam-detection: true

          # æ£€æµ‹ AI ç”Ÿæˆå†…å®¹
          ai-generated-detection: true

          # è‡ªå®šä¹‰æç¤º
          custom-prompt: |
            åˆ†æè¿™ä¸ª issue/è¯„è®ºæ˜¯å¦åŒ…å«ï¼š
            1. åƒåœ¾ä¿¡æ¯æˆ–å¹¿å‘Š
            2. çº¯ AI ç”Ÿæˆçš„æ— æ„ä¹‰å†…å®¹
            3. æ¶æ„æˆ–æ”»å‡»æ€§å†…å®¹
            4. ä¸é¡¹ç›®æ— å…³çš„å†…å®¹

            å¦‚æœæ˜¯åƒåœ¾å†…å®¹ï¼Œè¿”å› "SPAM"
            å¦‚æœæ˜¯æ­£å¸¸å†…å®¹ï¼Œè¿”å› "OK"

          # åƒåœ¾å†…å®¹å¤„ç†
          on-spam:
            labels:
              - "spam"
            minimize: true  # éšè—å†…å®¹
            comment: |
              ğŸ¤– è¿™ä¸ª issue è¢« AI æ£€æµ‹ä¸ºå¯èƒ½çš„åƒåœ¾å†…å®¹ï¼Œå·²è‡ªåŠ¨éšè—ã€‚
              å¦‚æœè¿™æ˜¯è¯¯åˆ¤ï¼Œè¯·è”ç³»ç»´æŠ¤è€…ã€‚

              ğŸ¤– This issue was detected as potential spam by AI and has been hidden.
              If this is a false positive, please contact the maintainers.
